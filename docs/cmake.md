éå¸¸å¥½ï¼Œè¿™ä¸€ä¸²é—®é¢˜æ­£æ˜¯ **ç†è§£ CMake å·¥ä½œæœºåˆ¶çš„å…³é”®æ ¸å¿ƒç‚¹**ã€‚æˆ‘ä¼šé€å±‚å›ç­”ï¼Œè®©ä½ çŸ¥é“æ¯ä¸ªç»„ä»¶æ˜¯è°å¹²ä»€ä¹ˆçš„ã€æ€ä¹ˆå…³è”èµ·æ¥çš„ã€‚

---

## 1ï¸âƒ£ `CMakeLists.txt` æ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆå†™ï¼Ÿ

å®ƒæ˜¯ **CMake çš„é¡¹ç›®é…ç½®æ–‡ä»¶**ï¼Œç›¸å½“äº â€œé¡¹ç›®çš„è“å›¾â€ã€‚
æ‰€æœ‰ CMake çš„å‘½ä»¤éƒ½ä»å®ƒå¼€å§‹åˆ†æã€‚

æœ€å°ç¤ºä¾‹ï¼ˆä½ å¯ä»¥ç›´æ¥åœ¨é¡¹ç›®æ ¹ç›®å½•æ”¾è¿™ä¸ªï¼‰ï¼š

```cmake
cmake_minimum_required(VERSION 3.15)
project(MyApp VERSION 1.0 LANGUAGES CXX)

# æŒ‡å®š C++ æ ‡å‡†
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# æºæ–‡ä»¶åˆ—è¡¨
set(SOURCES
    src/main.cpp
    src/core/engine.cpp
)

# å®šä¹‰å¯æ‰§è¡Œæ–‡ä»¶
add_executable(myapp ${SOURCES})

# å¤´æ–‡ä»¶ç›®å½•
target_include_directories(myapp PUBLIC include)

# é“¾æ¥ç³»ç»Ÿåº“
target_link_libraries(myapp PRIVATE pthread)

# å®šä¹‰å®‰è£…è§„åˆ™
install(TARGETS myapp DESTINATION bin)
install(DIRECTORY include/ DESTINATION include)
```

è§£é‡Šï¼š

* `add_executable`ï¼šå‘Šè¯‰ CMake ä½ çš„å¯æ‰§è¡Œç¨‹åºå’Œæºæ–‡ä»¶ã€‚
* `target_include_directories`ï¼šå¤´æ–‡ä»¶è·¯å¾„ã€‚
* `target_link_libraries`ï¼šè¦é“¾æ¥çš„åº“ï¼ˆpthreadã€OpenGLã€etcï¼‰ã€‚
* `install(...)`ï¼šå‘Šè¯‰ CMake ä¹‹å `cmake --install .` è¦å¤åˆ¶åˆ°å“ªé‡Œã€‚

---

## 2ï¸âƒ£ `Makefile` æ˜¯ä»€ä¹ˆï¼Ÿ

å®ƒæ˜¯ **ä¼ ç»Ÿæ„å»ºè§„åˆ™æ–‡ä»¶**ã€‚
é‡Œé¢å†™ç€ã€Œå“ªä¸ªæ–‡ä»¶ä¾èµ–å“ªä¸ªæ–‡ä»¶ã€æ€ä¹ˆç¼–è¯‘å®ƒä»¬ã€ã€‚

ä¾‹å­ï¼ˆç®€åŒ–ï¼‰ï¼š

```makefile
main.o: main.cpp
	g++ -c main.cpp -o main.o

engine.o: engine.cpp
	g++ -c engine.cpp -o engine.o

myapp: main.o engine.o
	g++ main.o engine.o -o myapp -lpthread
```

CMake å°±æ˜¯å¸®ä½  **è‡ªåŠ¨ç”Ÿæˆè¿™ä¸ª Makefile**ï¼ˆè€Œä¸æ˜¯æ‰‹å†™ï¼‰ã€‚

---

## 3ï¸âƒ£ `build.ninja` æ˜¯å¹²å˜›çš„ï¼Ÿ

`build.ninja` = Ninja æ„å»ºç³»ç»Ÿçš„è§„åˆ™æ–‡ä»¶ã€‚

å®ƒå’Œ Makefile æœ¬è´¨ä¸€æ ·ï¼Œéƒ½æ˜¯ã€Œå‘Šè¯‰æ„å»ºå·¥å…·å¦‚ä½•ç¼–è¯‘é¡¹ç›®ã€çš„è¯´æ˜ä¹¦ã€‚
åŒºåˆ«åœ¨äºï¼š

| å¯¹æ¯”é¡¹     | Makefile | build.ninja    |
| ------- | -------- | -------------- |
| æ„å»ºå·¥å…·    | make     | ninja          |
| æ–‡ä»¶è¯­æ³•    | å¤è€ã€å¤æ‚    | ç®€å•ã€æœºå™¨ç”Ÿæˆä¼˜åŒ–      |
| å¹¶è¡Œæ•ˆç‡    | ä¸€èˆ¬       | éå¸¸å¿«            |
| CMakeæ”¯æŒ | é»˜è®¤       | éœ€æŒ‡å®š `-G Ninja` |

ç”Ÿæˆ Ninja æ–‡ä»¶çš„å‘½ä»¤ï¼š

```bash
cmake .. -G Ninja
```

ç„¶åæ‰§è¡Œï¼š

```bash
cmake --build .
```

CMake ä¼šæ£€æµ‹ä½ é€‰æ‹©çš„ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰ã€‚
å¦‚æœæ˜¯ `Ninja`ï¼Œå®ƒå®é™…ä¸Šæ‰§è¡Œçš„å‘½ä»¤å°±æ˜¯ï¼š

```bash
ninja -j$(nproc)
```

ä¹Ÿå°±æ˜¯æˆ‘é‚£å¥ã€Œå¦‚æœä½ ç”¨çš„æ˜¯ Ninjaï¼Œè¿™é‡Œä¼šç”¨ ninja å®é™…æ‰§è¡Œã€ã€‚

---

## 4ï¸âƒ£ â€œæ€ä¹ˆçŸ¥é“æ˜¯ /usr é‡Œé¢çš„å“ªä¸ªå­æ–‡ä»¶å¤¹ï¼Ÿâ€

CMake æ ¹æ®ä½ çš„ `install()` æŒ‡ä»¤è‡ªåŠ¨å†³å®šã€‚
ä¾‹å¦‚ï¼š

| CMake æŒ‡ä»¤                                          | å®é™…å®‰è£…è·¯å¾„ï¼ˆå‡è®¾ prefix = /usrï¼‰  |
| ------------------------------------------------- | ------------------------- |
| `install(TARGETS myapp DESTINATION bin)`          | `/usr/bin/myapp`          |
| `install(FILES config.hpp DESTINATION include)`   | `/usr/include/config.hpp` |
| `install(DIRECTORY include/ DESTINATION include)` | `/usr/include/...`        |
| `install(TARGETS mylib DESTINATION lib)`          | `/usr/lib/libmylib.a`     |

ğŸ“Œ æ‰€ä»¥ä¸æ˜¯ CMake è‡ªå·±â€œçŒœâ€çš„ï¼Œè€Œæ˜¯æ ¹æ®ä½ åœ¨ `CMakeLists.txt` é‡Œå†™çš„è§„åˆ™æ‰§è¡Œã€‚

---

## 5ï¸âƒ£ â€œ`cmake .. -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/usr` æ˜¯æ€ä¹ˆè‡ªåŠ¨åˆ†æçš„ï¼Ÿâ€

æµç¨‹å¦‚ä¸‹ï¼š

1. CMake å…ˆè¯»å–å½“å‰ç›®å½•ï¼ˆè¿™é‡Œæ˜¯ `build/`ï¼‰
2. å®ƒçœ‹åˆ° `..` å‚æ•°ï¼Œå»ä¸Šä¸€çº§ç›®å½•æ‰¾ `CMakeLists.txt`
3. å®ƒåˆ†æ `CMakeLists.txt` ä¸­çš„é¡¹ç›®å®šä¹‰ï¼ˆ`project()`, `add_executable()`, `install()` ç­‰ï¼‰
4. æ ¹æ®è¿™äº›ä¿¡æ¯ï¼š

   * æ£€æŸ¥ç³»ç»Ÿä¸Šæœ‰å“ªäº›ç¼–è¯‘å™¨
   * æ£€æŸ¥å“ªäº›åº“å­˜åœ¨
   * ç”Ÿæˆç›¸åº”çš„æ„å»ºè§„åˆ™ï¼ˆMakefile æˆ– build.ninjaï¼‰
   * è®°å½•é€‰é¡¹å¦‚ `CMAKE_BUILD_TYPE` å’Œ `CMAKE_INSTALL_PREFIX`

è¿™äº›éƒ½ä¼šè¢«å†™å…¥ç¼“å­˜æ–‡ä»¶ `build/CMakeCache.txt`ï¼Œä½ å¯ä»¥æ‰“å¼€çœ‹çœ‹ï¼š

```txt
CMAKE_BUILD_TYPE:STRING=Release
CMAKE_INSTALL_PREFIX:PATH=/usr
CMAKE_CXX_COMPILER:FILEPATH=/usr/bin/g++
```

---

## 6ï¸âƒ£ å…³ç³»æ€»ç»“å›¾

```
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         CMakeLists.txt      â”‚ â† ä½ å†™çš„é…ç½®æ–‡ä»¶
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚  cmake ..
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  CMake ç”Ÿæˆ Makefile æˆ– Ninjaâ”‚ â† æ„å»ºè§„åˆ™
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚  cmake --build .
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   make / ninja è°ƒç”¨ g++     â”‚ â† å®é™…ç¼–è¯‘æ‰§è¡Œ
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚  cmake --install .
                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ /usr/bin, /usr/include ...  â”‚ â† å®‰è£…ç»“æœ
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

è¦ä¸è¦æˆ‘å¸®ä½ å†™ä¸€ä¸ªå®Œæ•´çš„è·¨å¹³å°ï¼ˆLinux/Windows éƒ½èƒ½ç¼–è¯‘ï¼‰çš„ `CMakeLists.txt` ç¤ºä¾‹ï¼Ÿ
å¯ä»¥è®©ä½ ç›´æ¥åˆ‡æ¢ Ninja / MSVC / GCC éƒ½é€šç”¨ã€‚
